#!/bin/bash #for-shellcheck
# This file gets sourced from .bashrc

# shellcheck disable=SC2142  # Allow fancy pants aliases with positional parameters
# Issue: SC2142 occurs when parameters are used in a function #1263
# https://github.com/koalaman/shellcheck/issues/1263

# ls aliases
# LS_BLOCK_SIZE = Separate thousands with ','
# https://www.gnu.org/software/coreutils/manual/html_node/Block-size.html
# -C = list entries by columns
# -F, --classify = append indicator (one of */=>@|) to entries
alias ls="ls -CF --block-size=\\'1 --color=auto --quoting-style=shell-escape"  #'"
alias la='ls -A'       # Almost all - no . and ..
alias lal='ls -la'
alias ll='ls -l'
alias lsd='ls -dla * --color=always | grep "^d" --color=never'   # non-hidden directories
alias lsdd='ls -Al --color=always | grep --color=never ^d'   # directories including hidden
alias lal='ls -la'
alias l.='ls -d .[^.]?*' # Hidden files except . and .. (current directory only)

alias -- -='cd -' # go to previous dir
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias .....='cd ../../../..'

# One letter aliases
alias g='git'
alias h='history'
alias j='jobs'
alias l='ll'  # l^J for ultimate laziness
alias q='ls'  # mnemonic: q = query
alias r='rake'
alias s='git s'

# Two letters
alias gh='git logda' # Git History
alias jc='journalctl'
alias sc='sudo systemctl'

alias scu='systemctl --user'

# Completions for aliases
# https://brbsix.github.io/2015/11/23/perform-tab-completion-for-aliases-in-bash/
# https://unix.stackexchange.com/questions/4219/how-do-i-get-bash-completion-for-command-aliases
# General format: complete -o bashdefault -o default -o nospace -F _git g
[[ -n $BASH_VERSION ]] && _completion_loader systemctl; complete -o bashdefault -o default -o nospace -F _systemctl sc

# Currently done as function
# https://stackoverflow.com/a/34071958/5353461
# alias sbin='export PATH=$(npm bin):$PATH'

# Configuration of base command
alias ag='ag --color'
alias cal='cal -3' # show 3 months by default
alias cp='cp --reflink=auto --sparse=always'
alias cuc='cucumber'
alias diff='diff --color=auto'
alias grep='GREP_COLOR="1;33;40" LANG=C grep --color=auto'
alias home='git --git-dir=$HOME/.githome --work-tree=$HOME'
alias lesc='less-compressed-wrapper'
alias nixnote2='LD_PRELOAD=libcurl.so.3 nixnote2 &'
alias rsync='rsync --sparse'
alias setvars='(set -o posix; set)'
alias vimpager='$XDG_DATA_HOME/vim/bundle/vimpager/vimpager'

# AUR helpers
alias pac=aurman
alias aurman='pacman_program="/usr/bin/aurman --optimistic_versioning" pacmatic'
alias pakku=' pacman_program=/usr/bin/pakku  pacmatic'
alias pacmatic='export PYTHONPATH=/usr/lib/python3.6/site-packages pacdiff_program="sudo pacdiff"; sudo /usr/bin/pacmatic' # AUR helpers can't be run as root

# tmux / tmuxinator
alias tmux='TERM=xterm-256color tmux -f "$XDG_CONFIG_HOME"/tmux/tmux.conf'
alias tmuxinator='TERM=xterm-256color tmuxinator'
alias mux='TERM=xterm-256color tmuxinator'

# head & tail
alias head='head -n $((${LINES:-12}-2))' # as many as possible without scrolling
alias tail='tail -n $((${LINES:-12}-2)) --sleep-interval=0.2' # 200ms

# Clipboard
alias pbcopy='xclip -selection clipboard -in'
alias pbpaste='xclip -selection clipboard -out'

# rsync
alias droidsync='f(){ rsync "$@" --no-p --no-o --no-g --rsync-path="su root rsync";};f'
# FAT stores to two-second accuracy, NTFS 100 nanoseconds
# https://corengen.wordpress.com/2010/03/22/comparing-file-timestamps-on-ntfs-and-fat32/
alias fatrsync='f(){ rsync "$@" --modify-window=2 --no-p --no-o --no-g;};f'
alias rsyncmv='rsync -a --remove-source-files'

# Allow completion for git aliases defined above
# See https://github.com/cykerway/complete-alias for a generic solution
if is_function __git_complete; then
  __git_complete g __git_main
  __git_complete home __git_main
  __git_complete s _git_status
fi
